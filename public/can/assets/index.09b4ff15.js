const m=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}};m();function s(e){const t=document.querySelector("#crux");t.innerHTML=e}function p(){let e;try{e=window.sessionStorage;const t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return e?t instanceof DOMException&&(t.code===22||t.code===1014||t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e&&e.length!==0:!1}}function w(){const e=new URLSearchParams(window.location.hash).get("access_token");typeof e=="string"&&e.length>0&&(sessionStorage.setItem("Authorization",e),window.location.hash="")}const f="https://greenstem-pine.auth.eu-west-1.amazoncognito.com/login?response_type=token&client_id=uedkl69k5q69qtietp85l2smb&redirect_uri=https://www.greenstem.uk/can",y=f.length>0?f:"https://www.greenstem.uk/can/";function b(e){const t=document.querySelector("header .login-or-out");t.innerHTML=e}function l(){const e=`<p><a href=${y}>Please log in </a></p>`;s(e),b(e)}async function x(){if(!p())return s(`
Please enable session-storage by reloading this page
after leaving incognito Private Browsing.
    `),!1;w();const e=sessionStorage.getItem("Authorization");return typeof e=="string"&&e.length>0?!0:(l(),!1)}async function d(e="",t="GET",n=""){const r=sessionStorage.getItem("Authorization");if(typeof r!="string"||r.length<1)throw l()," Authorization header missing from authorized-fetch ";const i="https://7hmryyd0m0.execute-api.eu-west-1.amazonaws.com"+e,c={method:t,headers:{Authorization:r}};return typeof n=="string"&&n.length>0&&(c.body=n),await fetch(i,c).then(a=>{if(!a.ok)throw console.warn(a.statusText),` Authorized fetch response not ok, ${a.statusText} `;return a.json()}).then(a=>{if(a.body)return a.body;throw a.error?` Fetching data returned error:- ${a.error}. `:" Data missing from fetch response. "})}function v(e){const t=document.querySelector("#greeting");t.innerText=`Hello ${e}`}async function S(){const e=await d("/data/email");return typeof e=="string"&&e.length>1?(v(e),!0):(l(),sessionStorage.clear(),!1)}async function k(e){s('<p class="loading">loading...</p>'),sessionStorage.setItem("examId",e),await u()}function I(){document.querySelectorAll(".discipline[id]").forEach(t=>{const n=t.getAttribute("id");t&&n&&(t.onclick=async()=>await k(n))})}async function L(){const e=await d("/data/disciplines");if(typeof e=="string"&&e.length>0){s(e),I();return}throw" Invalid disciplines-listings from show-disciplines function. "}async function g(){sessionStorage.removeItem("examId"),await u()}async function _(e){if(s('<p class="loading">loading...</p>'),e){await h(e);return}throw` Fault with candidate-answer ${e}. `}function A(){document.querySelectorAll(".choices[id]").forEach(n=>{const r=n.getAttribute("id");n&&r&&(n.onclick=async()=>await _(r))}),document.querySelectorAll(".jump-to-disciplines").forEach(n=>{n&&(n.onclick=async()=>{s('<p class="loading">loading...</p>'),await g()})})}async function T(e,t=""){const n=await d(`/data/exam/${e.replace(/#/g,"%23")}`,"POST",t);if(n==="end_of_exam-standard_fixed_id_ne5gei8phi0al0oM"){await g();return}if(typeof n=="string"&&n.length>0){s(n),A();return}throw" Invalid question-text from get-question-text function. "}async function h(e=""){const t=sessionStorage.getItem("examId");if(typeof t=="string"&&t.length>0){await T(t,e);return}throw" Exam-id missing from show-exam function. "}function E(){const e=document.querySelector("header .login-or-out a.egress");e!=null&&(e.onclick=()=>sessionStorage.clear())}async function u(){E();const e=sessionStorage.getItem("examId");if(typeof e=="string"&&e.length>0){await h();return}await L()}async function q(){if(!await x())return;if(!await S()){l();return}await u()}q().catch(e=>{sessionStorage.clear(),l(),console.warn(e)});

const m=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}};m();function a(e){const t=document.querySelector("#crux");t.innerHTML=e}function p(){let e;try{e=window.sessionStorage;const t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return e?t instanceof DOMException&&(t.code===22||t.code===1014||t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e&&e.length!==0:!1}}function y(){const e=new URLSearchParams(window.location.hash).get("access_token");typeof e=="string"&&e.length>0&&sessionStorage.setItem("Authorization",e)}const f="https://greenstem-pine.auth.eu-west-1.amazoncognito.com/login?response_type=token&client_id=uedkl69k5q69qtietp85l2smb&redirect_uri=https://main.d28kf1eii4y52x.amplifyapp.com/can",w=f.length>0?f:"https://www.greenstem.uk/can/";function l(){a(`<p class="ingress"><a href=${w}>Please log in </a></p>`)}async function x(){if(!p())return a(`
Please enable session-storage by reloading this page
after leaving incognito Private Browsing.
    `),!1;y();const e=sessionStorage.getItem("Authorization");return typeof e=="string"&&e.length>0?!0:(l(),!1)}async function u(e="",t="GET",n=""){const r=sessionStorage.getItem("Authorization");if(typeof r!="string"||r.length<1)throw l()," Authorization header missing from authorized-fetch ";const o="https://7hmryyd0m0.execute-api.eu-west-1.amazonaws.com"+e,c={method:t,headers:{Authorization:r}};return typeof n=="string"&&n.length>0&&(c.body=n),await fetch(o,c).then(s=>{if(!s.ok)throw console.warn(s.statusText),` Authorized fetch response not ok, ${s.statusText} `;return s.json()}).then(s=>{if(s.body)return s.body;throw s.error?` Fetching data returned error:- ${s.error}. `:" Data missing from fetch response. "})}function b(e){const t=document.querySelector("#greeting");t.innerText=`Hello ${e}`}async function S(){const e=await u("/data/email");return typeof e=="string"&&e.length>1?(b(e),!0):(l(),sessionStorage.clear(),!1)}async function v(e){a('<p class="loading">loading...</p>'),sessionStorage.setItem("examId",e),await d()}function k(){document.querySelectorAll(".discipline[id]").forEach(t=>{const n=t.getAttribute("id");t&&n&&(t.onclick=async()=>await v(n))})}async function I(){const e=await u("/data/disciplines");if(typeof e=="string"&&e.length>0){a(e),k();return}throw" Invalid disciplines-listings from show-disciplines function. "}async function h(){sessionStorage.removeItem("examId"),await d()}async function _(e){if(a('<p class="loading">loading...</p>'),e){await g(e);return}throw` Fault with candidate-answer ${e}. `}function A(){document.querySelectorAll(".choices[id]").forEach(n=>{const r=n.getAttribute("id");n&&r&&(n.onclick=async()=>await _(r))}),document.querySelectorAll(".jump-to-disciplines").forEach(n=>{n&&(n.onclick=async()=>{a('<p class="loading">loading...</p>'),await h()})})}async function E(e,t=""){const n=await u(`/data/exam/${e.replace(/#/g,"%23")}`,"POST",t);if(n==="end_of_exam-standard_fixed_id_ne5gei8phi0al0oM"){await h();return}if(typeof n=="string"&&n.length>0){a(n),A();return}throw" Invalid question-text from get-question-text function. "}async function g(e=""){const t=sessionStorage.getItem("examId");if(typeof t=="string"&&t.length>0){await E(t,e);return}throw" Exam-id missing from show-exam function. "}async function d(){const e=sessionStorage.getItem("examId");if(typeof e=="string"&&e.length>0){await g();return}await I()}async function L(){if(!await x())return;if(!await S()){l();return}await d()}L().catch(e=>{sessionStorage.clear(),l(),console.warn(e)});

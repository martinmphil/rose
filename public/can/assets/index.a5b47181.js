const g=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function o(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=o(n);fetch(n.href,i)}};g();function c(e){const t=document.querySelector("#crux");t.innerHTML=e}function m(){let e;try{e=window.sessionStorage;const t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return e?t instanceof DOMException&&(t.code===22||t.code===1014||t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e&&e.length!==0:!1}}function p(){const e=new URLSearchParams(window.location.hash).get("access_token");typeof e=="string"&&e.length>0&&sessionStorage.setItem("Authorization",e)}const d="https://greenstem-pine.auth.eu-west-1.amazoncognito.com/login?response_type=token&client_id=uedkl69k5q69qtietp85l2smb&redirect_uri=https://main.d28kf1eii4y52x.amplifyapp.com/can",y=d.length>0?d:"https://www.greenstem.uk/can/";function l(){c(`<p class="ingress"><a href=${y}>Please log in </a></p>`)}async function w(){if(!m())return c(`
Please enable session-storage by reloading this page
after leaving incognito Private Browsing.
    `),!1;p();const e=sessionStorage.getItem("Authorization");return typeof e=="string"&&e.length>0?!0:(l(),!1)}async function u(e="",t="GET",o=""){const s=sessionStorage.getItem("Authorization");if(typeof s!="string"||s.length<1)throw l()," Authorization header missing from authorized-fetch ";const i="https://7hmryyd0m0.execute-api.eu-west-1.amazonaws.com"+e;console.log(i);const a={method:t,headers:{Authorization:s}};return typeof o=="string"&&o.length>0&&(a.body=o),await fetch(i,a).then(r=>{if(!r.ok)throw console.warn(r.statusText),` Authorized fetch response not ok, ${r.statusText} `;return r.json()}).then(r=>{if(r.body)return r.body;throw r.error?` Fetching data returned error:- ${r.error}. `:" The body-field absent from fetched data. "})}function x(e){const t=document.querySelector("#greeting");t.innerText=`Hello ${e}`}async function b(){const e=await u("/data/email");return typeof e=="string"&&e.length>1?(x(e),!0):(l(),sessionStorage.clear(),!1)}async function S(e){c('<p class="loading">loading...</p>'),sessionStorage.setItem("examId",e),await h()}function v(){document.querySelectorAll(".discipline[id]").forEach(t=>{const o=t.getAttribute("id");t&&o&&(t.onclick=async()=>await S(o))})}async function k(){const e=await u("/data/disciplines");if(typeof e=="string"&&e.length>0){c(e),v();return}throw" Invalid disciplines-listings from show-disciplines function. "}async function A(e){c('<p class="loading">loading...</p>'),console.log(`User answer is ${e}. Now this must be submitted`),await f()}function I(){document.querySelectorAll(".answer-choice[id]").forEach(t=>{const o=t.getAttribute("id");t&&o&&(t.onclick=async()=>await A(o))})}async function T(e){const t=await u(`/data/exam/${e}`,"POST");if(typeof t=="string"&&t.length>0){c(t),I();return}throw" Invalid question-text from get-question-text function. "}async function f(){const e=sessionStorage.getItem("examId");if(typeof e=="string"&&e.length>0){await T(e);return}throw" Exam-id missing from show-exam function. "}async function h(){const e=sessionStorage.getItem("examId");if(typeof e=="string"&&e.length>0){await f();return}await k()}async function _(){if(!await w())return;if(!await b()){l();return}await h()}_().catch(e=>{sessionStorage.clear(),l(),console.warn(e)});
